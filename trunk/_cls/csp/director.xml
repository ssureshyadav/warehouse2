<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.director">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62301,49220.374372</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""load()"">"
	Write !,"<TABLE cellSpacing=0 width=""100%"" celpadding=""0"" >",!
	Write "<TR>",!
	Write "<td width=10%>"
	Write "<img alt=""Обновить раздел"" src=""images/refresh.gif"" onclick=""window.location.reload()"" style=""cursor:hand"">"
	Write "</td>",!
	Write "<TD width=80% align=center style=""BACKGROUND: rgb(233,243,255); FONT-size: 18px ; font-family: arial; COLOR: rgb(0,0,102); BORDER-BOTTOM: rgb(0,0,102) 1px solid"" colspan=2><strong>Рабочее место руководителя предприятия</strong></TD>",!
	Write "<td  width=10% align=right>"
	Write "<!--<a href=""talk.csp"" ><img src=""images/BIGProp.gif"" width=""20"" height=25 border=0></a>-->"
	Write "</td>",!
	Write "</tr>",!
	Write "</TABLE>",!
	Write !,"<!-- заявки с негативными отзывами -->"
	Write !,"<br><br>",!
	Write "<fieldset><legend>Заявки на которые есть негативные отзывы</legend>",!
	Write !,"	Федеральный округ: "
	Write "<select id=""FedOkr0"">"
	Write !,"	"
	Write "<option value=""undefined"">"
	Write "Все</option>",!
	Write "	"
	w ##class(Docs.Action2).GetClassValuesOptions("","Common.Dictionary18",,,0)
	Write !,"	"
	Write "</select>"
	Write !,!,"	Период c "
	Write "<input type=text id=""dat11"" value="""_("1/"_+$ZD($H,1)_"/"_+$ZD($H,3))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""dat21"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"	"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut11.src='images/Onok.gif'"" onmouseout=""okbut11.src='images/ok.gif'""  id=""okbut11"" name=""okbut11"" alt=""Показать записи"" onclick=""ShowInstr()"" style="""">"
	Write "<br>",!
	Write "	<SKLADList:listview width=100% height=350 id=""instr"" onAddColumns=""ShowInstr()"" ClassName=""Operation.Instructions"" zonDblClick=""PrintInstr(instr.ItemID)"" Skip=""Source->Name,child->Name"" />",!
	Write "	"
	Write !,"<img src=""images/print.gif"" onmouseover=""printInstr.src='images/Onprint.gif'"" onmouseout=""printInstr.src='images/print.gif'""  id=""printInstr"" name=""printInstr"" alt=""Печать инстукции"" onclick=""PrintInstr(instr.ItemID)"" style="""">"
	Write !,"</fieldset>",!
	Write !,"<!-- акты -->"
	Write !,"<br><br>",!
	Write "<fieldset><legend>Акты</legend>",!
	Write "	Федеральный округ: "
	Write "<select id=""FedOkr1"">"
	Write !,"	"
	Write "<option value=""undefined"">"
	Write "Все</option>",!
	Write "	"
	w ##class(Docs.Action2).GetClassValuesOptions("","Common.Dictionary18",,,0)
	Write !,"	"
	Write "</select>"
	Write !,"	Период c "
	Write "<input type=text id=""dat12"" value="""_("1/"_+$ZD($H,1)_"/"_+$ZD($H,3))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""dat22"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"	"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut22.src='images/Onok.gif'"" onmouseout=""okbut22.src='images/ok.gif'""  id=""okbut22"" name=""okbut22"" alt=""Показать записи"" onclick=""ShowActs()"" style="""">"
	Write "<br>",!
	Write "	<SKLADList:listview width=100% height=350 id=""acts"" onAddColumns=""ShowActs()"" ClassName=""Docs.Act"" zonDblClick=""PrintAct(acts.ItemID)"" Skip=""Source->Name,child->Name"" />",!
	Write "	"
	Write !,"<img src=""images/print.gif"" onmouseover=""printActBut.src='images/Onprint.gif'"" onmouseout=""printActBut.src='images/print.gif'""  id=""printActBut"" name=""printActBut"" alt=""Печать акта"" onclick=""PrintAct(acts.ItemID)"" style="""">"
	Write !,"</fieldset>",!
	Write !,"<!-- отправка запчастей по федеральным округам -->"
	Write !,!,"<br><br>",!
	Write "<fieldset><legend>Отправка запчастей</legend>",!
	Write "	Федеральный округ: "
	Write "<select id=""FedOkr"">"
	Write !,"	"
	Write "<option value="""">"
	Write "Все</option>",!
	Write "	"
	w ##class(Docs.Action2).GetClassValuesOptions("","Common.Dictionary18",,,0)
	Write !,"	"
	Write "</select>"
	Write !,"	Период c "
	Write "<input type=text id=""dat13"" value="""_("1/"_+$ZD($H,1)_"/"_+$ZD($H,3))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""dat23"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"	"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut33.src='images/Onok.gif'"" onmouseout=""okbut33.src='images/ok.gif'""  id=""okbut33"" name=""okbut33"" alt=""Показать записи"" onclick=""ShowZap()"" style="""">"
	Write "<br>",!
	Write "	<SKLADList:listview width=100% height=350 id=""zap"" zonDblClick=""PrintZap(zap.ItemID)"" />",!
	Write "	"
	Write !,"<img src=""images/print.gif"" onmouseover=""printZapBut.src='images/Onprint.gif'"" onmouseout=""printZapBut.src='images/print.gif'""  id=""printZapBut"" name=""printZapBut"" alt=""Печать инструкции"" onclick=""PrintZap(zap.ItemID)"" style="""">"
	Write !,"</fieldset>",!
	Write !,"</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !,!,"<title>	Рабочее место руководителя предприятия </title>",!
	Write "<script language=""javascript"">"
	Write !,"sessionid="""_(%session.SessionId)_""";",!
	Write !,!,"function load()",!
	Write "{",!
	Write "	instr.LoadHeaders(""Tim,Dat,Summa,Stat,Operation,showcolor,postnumber,postdata,PhotoFile,imp,innerinstr"");",!
	Write "	var ActsExcludeFields = ""Tim,Dat,Summa,SellerAddress,SellerDate,SellerPhone,ExpertDate,RemontDate,RemontDate,DefectEstimate,DefectClass,RepairRefuseReason,CustomerDoc,CustomerAddress,CustomerPhone,GoodsKeeping,SrvAddr,SrvPhone,Stat,CheckResult,ActType,PaidTime,PaidUser,CloseDate,CloseTime,CloseUser,DefectClassDescr,Goods"";",!
	Write "	var ActsAdditionalFields = ""Goods->FullName~Изделие~~~@%String~~~~~#@#"";",!
	Write "	acts.LoadHeaders(ActsExcludeFields,"""",ActsAdditionalFields);",!
	Write "	ShowZap();",!
	Write "}",!
	Write !,"// показать инструкции",!
	Write "function ShowInstr()",!
	Write "{",!
	Write "	var Data1=ConvertDateSql(dat11.value);",!
	Write "	var Data2=ConvertDateSql(dat21.value);",!
	Write "	var Federal=FedOkr0.value;",!
	Write "	instr.DownLoad(""InstDate>=CAST('""+Data1+""' AS DATE) and InstDate<=CAST('""+Data2+""' AS DATE) and BrakComment<>'' and (Kontr->Federal='""+Federal+""' OR 'undefined'='""+Federal+""')""); ",!
	Write "}",!
	Write !,"// показать акты",!
	Write "function ShowActs()",!
	Write "{",!
	Write "	var Data1=ConvertDateSql(dat12.value);",!
	Write "	var Data2=ConvertDateSql(dat22.value);",!
	Write "	var Federal=FedOkr1.value;",!
	Write "	acts.DownLoad(""Dat>=CAST('""+Data1+""' AS DATE) and Dat<=CAST('""+Data2+""' AS DATE) and Stat=2 and (Kontr->Federal='""+Federal+""' OR 'undefined'='""+Federal+""')"");",!
	Write "	",!
	Write "}",!
	Write !,"// показать заявки данного федерального округа",!
	Write "function ShowZap()",!
	Write "{",!
	Write "	zap.loadfrommethod(""Reports.ShowTables.ShowDetailsSent"",FedOkr.value,dat13.value,dat23.value)",!
	Write "}",!
	Write !,"// Печать инструкции",!
	Write "function PrintInstr(ItemID)",!
	Write "{",!
	Write "	if(ReturnSpace(ItemID)=="""")return",!
	Write "	window.open(""screen/ChiefInstr.csp?docid=""+ItemID)",!
	Write "}",!
	Write !,"// Печать акта",!
	Write "function PrintAct(ItemID)",!
	Write "{",!
	Write "	if(ReturnSpace(ItemID)=="""")return",!
	Write "	var url=""print.csp?id=""+ItemID+""&class=""+acts.ClassName+""&sessionid=""+sessionid",!
	Write "	window.open(url);",!
	Write "}",!
	Write !,"// Печать инструкции",!
	Write "function PrintZap(ItemID)",!
	Write "{",!
	Write "	if(ReturnSpace(ItemID)=="""")return",!
	Write "	window.open(""screen/ChiefInstr.csp?docid=""+ItemID)",!
	Write "}",!
	Write !,"</script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLADList>"
	Write !,"<IMPORT NAMESPACE=""SKLADList"" IMPLEMENTATION=""htc/listview2.htc"">",!
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  s login=$G(%session.Data("user"))
  i '+login s %response.ServerSideRedirect="norights.csp" 
  s Access13func=##class(Common.Rights).getrights(+login,13)
  i '+Access13func s %response.ServerSideRedirect="norights.csp" 
  q 1
 
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\director.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/director.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62164,45157</Default>
</Parameter>
</Class>
</Export>
