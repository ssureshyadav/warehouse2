<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.analyzis">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62301,49218.65941</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""load();"">"
	Write !,(##class(%CSP.Response).HyperEventBody())
	Write !,"<TABLE cellSpacing=0 width=""100%"" celpadding=""0"" >",!
	Write "<TR>",!
	Write "<td width=10%>"
	Write "<img alt=""Обновить раздел"" src=""images/refresh.gif"" onclick=""window.location.reload()"">"
	Write "</td>",!
	Write "<TD width=80% align=center style=""BACKGROUND: rgb(233,243,255); FONT-size: 18px ; font-family: arial; COLOR: rgb(0,0,102); BORDER-BOTTOM: rgb(0,0,102) 1px solid"" colspan=3><strong>Аналитика</strong></TD>",!
	Write "<td width=10%></td>",!
	Write "</tr>",!
	Write "</table>",!
	Write "<table width=100%><tr><td>Приход/расход за период c "
	Write "<input type=text id=""dat1"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"<select id=""depotelem"" style='behavior:url(#default#download)'>"
	Write "</select>"
	Write !,"<SKLAD2:table id=""PropTable1"" width=260 ClassName=""Docs.Super"" />",!
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut.src='images/Onok.gif'"" onmouseout=""okbut.src='images/ok.gif'""  id=""okbut"" name=""okbut"" alt=""Показать документы"" onclick=""show()"" style="""">"
	Write !,"<td align=""right"">скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep1"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report"" style=""display:none"" onMethodComplite=""this.style.display=''"" ClassName=""Operation.Instructions"" zonDblClick=""ff()""/><br>",!
	Write !,!,"<hr width=80%>",!
	Write "<table width=100%><tr><td><nobr>Текущий остаток </nobr><td><SKLAD2:table id=""PropTable"" width=260 ClassName=""Docs.InventItems"" /><td>"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut2.src='images/Onok.gif'"" onmouseout=""okbut2.src='images/ok.gif'""  id=""okbut2"" name=""okbut2"" alt=""Показать остатки"" onclick=""showost()"" style="""">"
	Write !,"<td align=""right"" width=100%>скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep2"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report2"" style=""display:none"" onMethodComplite=""this.style.display=''"" zonDblClick=""gcard(this.ItemID)""/><br>",!
	Write !,!,"<hr width=80%>",!
	Write "<table width=100% ><tr><td align=left>Поиск ",!
	Write "<select id=""Rep4DocsSelector"">"
	Write !,"<option value="""">"
	Write "Всех документов</option>",!
	Write "<option value=""Brak"">"
	Write "Документов брака</option>",!
	Write "</select>"
	Write " за период c "
	Write "<input type=text id=""rep4dat1"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""rep4dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по атрибутам товаров "
	Write "<input type=""button"" value=""установить значения свойств"" onclick=""rep4help();"">"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut4.src='images/Onok.gif'"" onmouseout=""okbut4.src='images/ok.gif'""  id=""okbut4"" name=""okbut4"" alt=""Показать остатки"" onclick=""showdocs()"" style="""">"
	Write !,"<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep4"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<span id=""report4span"" style=""display:none"">"
	Write !,"<SKLADList:listview width=100% height=200 id=""report4"" onMethodComplite=""report4span.style.display=''"" zonDblClick=""PrintDocument(this.ItemID)""/><br>",!
	Write "<br><font size=""3"" color=""lightgrey"">Двойной клик откроет форму печати документа</font>",!
	Write "</span>"
	Write !,!,"<hr width=80%>",!
	Write "<table width=100% ><tr><td align=left>Прогноз обнуления остатков на дату "
	Write "<input type=text id=""dat3"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut3.src='images/Onok.gif'"" onmouseout=""okbut3.src='images/ok.gif'""  id=""okbut3"" name=""okbut3"" alt=""Показать прогноз"" onclick=""shownull()"" style="""">"
	Write !,"<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep3"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report3"" style=""display:none"" onMethodComplite=""this.style.display=''"" zonDblClick=""gcard(this.ItemID)""/><br>",!
	Write !,"<hr width=80%>",!
	Write "<table width=100% ><tr><td align=left>Поиск  за период c "
	Write "<input type=text id=""rep5dat1"" value="""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""rep5dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " ",!
	Write "<select id=""typDocsSel"">"
	Write !
	w ##class(Docs.Action2).GetClassValuesOptions("","Docs.Docs")
	Write !,"</select>"
	Write !,"<input type=""button"" value=""Параметры"" onclick=""rep5params()"">"
	Write !,!,"<img src=""images/ok.gif"" onmouseover=""okbut5.src='images/Onok.gif'"" onmouseout=""okbut5.src='images/ok.gif'""  id=""okbut5"" name=""okbut5"" alt=""Вывести документы"" onclick=""showdocs2()"" style="""">"
	Write !,"<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep5"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report5"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write !,"<hr width=80%>",!
	Write "<table width=100% ><tr><td align=left>Отправка запчастей за период c "
	Write "<input type=text id=""rep6dat1"" value="""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text id=""rep6dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write "  ",!
	Write "Объединять марки "
	Write "<input type=""text"" id=""rep6models"">"
	Write " в название "
	Write "<input type=""text"" id=""rep6group"">"
	Write !,!,"<img src=""images/ok.gif"" onmouseover=""okbut6.src='images/Onok.gif'"" onmouseout=""okbut6.src='images/ok.gif'""  id=""okbut6"" name=""okbut6"" alt=""Вывести документы"" onclick=""showReport6()"" style="""">"
	Write !,"<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep6"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report6"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write !,"<hr width=80%>",!
	Write "<table width=100% ><tr><td align=left>Отправка "
	Write "<span title=""Указать запчасти отправку которых необходимо проследить"" onmouseout=""UnPaint(this)"" onclick=""GoodsForRep7()"" onmouseover=""Paint(this)"" style=""cursor:hand"">"
	Write "запчастей"
	Write "</span>"
	Write "  за период c "
	Write "<input type=text id=""rep7dat1"" value="""_($ZD($H,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep7dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write "  ",!
	Write "Клиенту "
	Write "<span onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" class=Kontragent onclick=""ChooseKonragent(this)"" id=""Kontr"" Tag="""" title=""Указать клиента, что бы очистить поле нажмите правую кнопку мыши"" oncontextmenu=""this.innerText='';this.Tag=''"">"
	Write "</span>"
	Write !,!,"<img src=""images/ok.gif"" onmouseover=""okbut7.src='images/Onok.gif'"" onmouseout=""okbut7.src='images/ok.gif'""  id=""okbut7"" name=""okbut7"" alt=""Вывести отчёт"" onclick=""showReport7()"" style="""">"
	Write !,"<br>",!
	Write "<span title=""Указать запчасти отправку которых необходимо проследить"" Tag="""">"
	Write "Запчасти выбранные для ремонта:"
	Write "</span>"
	Write " "
	Write "<span onclick=""GoodsForRep7()"" id=""Rep7TovarNames"" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" style=""border:solid 1 black;cursor:hand"" Tag="""">"
	Write "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
	Write "</span>"
	Write !,"<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep7"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report7"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write !,"<hr width=80%>",!
	Write "<table width=100% ><tr><td align=left>Список контрагентов которые не заказывали запчасти c "
	Write "<input type=text id=""rep8dat1"" value="""_($ZD($H-30,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep8dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write "  ",!
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut8.src='images/Onok.gif'"" onmouseout=""okbut8.src='images/ok.gif'""  id=""okbut8"" name=""okbut8"" alt=""Вывести отчёт"" onclick=""showReport8()"" style="""">"
	Write !,"<br>",!
	Write "<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep8"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report8"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write !,"<hr width=80%>",!
	Write "<table width=100%><tr><td align=left>",!
	Write "Прогноз обнуления остатков <br>",!
	Write "<span id=""Rep9Result"">"
	Write "</span>"
	Write !,"<table border=0 class=""ta"" cellspacing=0 ><tr>",!
	Write "<td class=""td"">",!
	Write "	"
	Write "<select id=""Rep9Select"" onchange=""Rep9SelectFn()"">"
	Write "<option value=""term"">"
	Write "Указать период</option>"
	Write "<option value=""winter"">"
	Write "Зима</option>"
	Write "<option value=""summer"">"
	Write "Лето</option>"
	Write "<option value=""year"">"
	Write "Год</option>"
	Write "</select>"
	Write !,"	"
	Write "<span id=""Rep9Term"">"
	Write " период c "
	Write "<input type=text id=""rep9dat1"" value="""_($ZD($H-30,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep9dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " "
	Write "</span>"
	Write !,"</td>",!
	Write "<td class=""td"">",!
	Write "	Начальные буквы аббревиатуры "
	Write "<input type=""text"" id=""Rep9abbr"" style=""width:40px"">"
	Write !,"</td>",!
	Write "<td class=""td"">",!
	Write "	"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut9.src='images/Onok.gif'"" onmouseout=""okbut9.src='images/ok.gif'""  id=""okbut9"" name=""okbut9"" alt=""Вывести отчёт"" onclick=""showReport9()"" style="""">"
	Write !,"</td>",!
	Write "</tr></table>",!
	Write "<br>",!
	Write "<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep9"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report9"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write !,"<hr width=80%>",!
	Write "<table width=100%><tr><td align=left>",!
	Write "Контроль сроков обработки заявки "
	Write !,"<img src=""images/help2.gif"" onmouseover=""help10.src='images/Onhelp2.gif'"" onmouseout=""help10.src='images/help2.gif'""  id=""help10"" name=""help10"" alt=""Помощь по отчёту"" onclick=""window.open('help/index.html?AnalyzSendTermControl.html')"" style="""">"
	Write "<br>",!
	Write "<table class=""ta"" cellspacing=0>",!
	Write "<tr>",!
	Write "	<td class=""td"">",!
	Write "		Период c "
	Write "<input type=text id=""rep10dat1"" value="""_($ZD($H-30,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"" title=""Начальная дата для выборки заявок"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep10dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"" title=""Конечная дата для выборки заявок"">"
	Write " ",!
	Write "	</td>",!
	Write "	<td class=""td"">",!
	Write "		Максимальный срок обработки: "
	Write "<input type=text value=5 id=""rep10term"" style=""width:30px"" title=""Количество дней предусмотренное для отправки заявки."">"
	Write " ",!
	Write "	</td>",!
	Write "	<td rowspan=2 class=""td"">",!
	Write "		"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut10.src='images/Onok.gif'"" onmouseout=""okbut10.src='images/ok.gif'""  id=""okbut10"" name=""okbut10"" alt=""Вывести отчёт"" onclick=""showReport10()"" style="""">"
	Write !,"	</td>",!
	Write "</tr>",!
	Write "<tr>",!
	Write "	<td class=""td"" title=""Если указать какой либо тип оплаты, то иные заявки не попадут в выборку."">",!
	Write "		Тип оплаты заявки: "
	Write "<select id=""Rep10Select"">"
	Write !,"			"
	w ##class(Docs.Action2).GetClassValuesOptions("","Common.Dictionary7")
	Write !,"		"
	Write "</select>"
	Write !,"	</td>",!
	Write "	<td class=""td"">",!
	Write "		Выводить все инструкции "
	Write "<input type=""checkbox"" id=""Rep10checkbox"" style=""width:15px;border:none"" title=""Выводить все заявки, а не подходящие по сроку подсвечивать."">"
	Write !,"	</td>",!
	Write "</tr>",!
	Write "</table>",!
	Write "<br>",!
	Write "<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep10"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report10"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write "<span id=""Rep10Legend"" style=""display:none"">"
	Write !,"<table>",!
	Write "<tr><td bgcolor=""#ff0000"">&nbsp;&nbsp;&nbsp;&nbsp;</td><td>Отправленные с опозданием</td></tr>",!
	Write "<tr><td bgcolor=""#7b0000"">&nbsp;&nbsp;&nbsp;&nbsp;</td><td>Не отправленные</td></tr>",!
	Write "</table>",!
	Write "</span>"
	Write !,!,"<hr width=80%>",!
	Write "<table width=100%><tr><td align=left>",!
	Write "Запчасти которые требовал клиент и которые не были отправлены<br>",!
	Write "Период c "
	Write "<input type=text id=""rep11dat1"" value="""_($ZD($H-30,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep11dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " ",!
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut11.src='images/Onok.gif'"" onmouseout=""okbut11.src='images/ok.gif'""  id=""okbut11"" name=""okbut11"" alt=""Вывести отчёт"" onclick=""showReport11()"" style="""">"
	Write !,"<br>",!
	Write "<td align=""right"" >скрыть "
	Write "<input type=""checkbox"" style=""border:0;width:15"" id=""rep11"" CHECKED onclick=""showhide(this.id)"">"
	Write !,"</table>",!
	Write "<SKLADList:listview width=100% height=200 id=""report11"" style=""display:none"" onMethodComplite=""this.style.display=''"" /><br>",!
	Write !,"<hr width=80%>",!
	Write "Суммы отгрузок по брендам (MM,TL,VC)<br>",!
	Write "<table class=""ta"" cellspacing=0>",!
	Write "<tr><td class=""td"">Период c "
	Write "<input type=text id=""rep12dat1"" value="""_($ZD($H-30,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep12dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write "</td><td class=""td"" rowspan=""3"">"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut12.src='images/Onok.gif'"" onmouseout=""okbut12.src='images/ok.gif'""  id=""okbut12"" name=""okbut12"" alt=""Вывести отчёт"" onclick=""showReport12()"" style="""">"
	Write "</td></tr>",!
	Write "<tr><td class=""td"">Выводить с помощью "
	Write "<select id=""rep12select"">"
	Write "<option value=""application/x-msexcel"">"
	Write "Excel</option>"
	Write "<option value=""text/html"">"
	Write "Internet Explorer</option>"
	Write "</select>"
	Write "</td></tr>",!
	Write "<!-- <tr><td class=""td"">Показывать документ и дату продажи <input type=""checkbox"" id=""rep12cb"" checked style=""width:15;border:none""></td></tr> -->"
	Write !,"</table>",!
	Write !,"<hr width=80%>",!
	Write "Количество заявок в системе<br>",!
	Write "<table class=""ta"" cellspacing=0>",!
	Write "<tr><td class=""td"">Период c "
	Write "<input type=text id=""rep13dat1"" value="""_($ZD($H-30,4))_""" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" onclick=""fnCalendar(this)"" class=""datar"">"
	Write " по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep13dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write "</td><td class=""td"" rowspan=""3"">"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut13.src='images/Onok.gif'"" onmouseout=""okbut13.src='images/ok.gif'""  id=""okbut13"" name=""okbut13"" alt=""Вывести отчёт"" onclick=""showReport13()"" style="""">"
	Write "</td></tr>",!
	Write "<tr><td class=""td"">Выводить с помощью "
	Write "<select id=""rep13select"">"
	Write "<option value=""application/x-msexcel"">"
	Write "Excel</option>"
	Write "<option value=""text/html"">"
	Write "Internet Explorer</option>"
	Write "</select>"
	Write "</td></tr>",!
	Write "<!-- <tr><td class=""td"">Показывать документ и дату продажи <input type=""checkbox"" id=""rep12cb"" checked style=""width:15;border:none""></td></tr> -->"
	Write !,"</table>",!
	Write !,"<hr width=80%>",!
	Write "Сумма остатка<br>",!
	Write "<table class=""ta"" cellspacing=0>",!
	Write "<tr>",!
	Write "	<td class=""td"">Классификатор: "
	Write "<select id=""rep14CatalogueSelect"">"
	Write !
	w ##class(Docs.Action2).GetClassValuesOptions("","Goods.Catalogue")
	Write !,"</select>"
	Write " Учитывать резерв "
	Write "<input type=""checkbox"" id=""rep14Rezerv"" style=""border:0;width:15"">"
	Write !,"	</td>",!
	Write "	<td class=""td"" rowspan=""3"">"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut14.src='images/Onok.gif'"" onmouseout=""okbut14.src='images/ok.gif'""  id=""okbut14"" name=""okbut14"" alt=""Вывести отчёт"" onclick=""showReport14()"" style="""">"
	Write "</td>",!
	Write "</tr>",!
	Write "<tr>",!
	Write "	<td class=""td"">Выводить с помощью "
	Write "<select id=""rep14select"">"
	Write "<option value=""application/x-msexcel"">"
	Write "Excel</option>"
	Write "<option value=""text/html"">"
	Write "Internet Explorer</option>"
	Write "</select>"
	Write "</td>",!
	Write "</tr>",!
	Write "</table>",!
	Write !,"<hr width=80%>",!
	Write "Статистика ремонта изделий<br>",!
	Write "<table class=""ta"" cellspacing=0>",!
	Write "<tr>",!
	Write "	<td class=""td"">Округ: "
	Write "<select id=""rep15Select"">"
	Write !
	w ##class(Docs.Action2).GetClassValuesOptions("","Common.Dictionary18")
	Write !,"</select>"
	Write " ",!
	Write "	с "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep15dat1"" value="""_(YearBeginDate)_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"	по "
	Write "<input type=text onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" id=""rep15dat2"" value="""_($ZD($H,4))_""" onclick=""fnCalendar(this)"" class=""datar"">"
	Write !,"	</td>",!
	Write "	<td class=""td"" rowspan=""3"">"
	Write !,"<img src=""images/ok.gif"" onmouseover=""okbut15.src='images/Onok.gif'"" onmouseout=""okbut15.src='images/ok.gif'""  id=""okbut15"" name=""okbut15"" alt=""Вывести отчёт"" onclick=""showReport15()"" style="""">"
	Write "</td>",!
	Write "</tr>",!
	Write "<tr>",!
	Write "	<td class=""td"">Выводить с помощью "
	Write "<select id=""rep15select"">"
	Write "<option value=""excel"">"
	Write "Excel</option>"
	Write "<option value=""html"">"
	Write "Internet Explorer</option>"
	Write "</select>"
	Write "</td>",!
	Write "</tr>",!
	Write "</table>",!
	Write !,"<hr width=80%>",!
	Write !,"<a href="""_(..EscapeHTML(..Link("rrr.csp")))_""">"
	Write "расход по брендам"
	Write "</a>"
	Write !,"</body>"
	Write !,(..HyperEventFrame(0))
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !,!
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<title>"_($G(%session.Data("systemname")))_"</title>",!
	Write "<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<style>"
	Write !,".Kontragent{width:230px;cursor:hand;border:solid 1 black}",!
	Write ".ta{border-left:1.0pt solid windowtext;border-top:1.0pt solid windowtext;}",!
	Write ".td{border-right:1.0pt solid windowtext;border-bottom:1.0pt solid windowtext;}",!
	Write "</style>"
	Write !,!,"<script language=""Jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<script language=""JScript"">"
	Write !,"sessionid="""_(%session.SessionId)_""";",!
	Write "login="""_(%session.Data("login"))_""";",!
	Write "var goodspars="""";",!
	Write "var docparams="""";",!
	Write !,"// разбор ItemID и вывод документа на печать",!
	Write "function PrintDocument(ItemID)",!
	Write "{",!
	Write "var docid = ItemID.split(""@"")[0];",!
	Write "var docclass = ItemID.split(""@"")[1];",!
	Write "var url=""print.csp?id=""+docid+""&class=""+docclass+""&sessionid=""+sessionid;	",!
	Write "window.open(url);",!
	Write "}",!
	Write !,"function ff(){",!
	Write "var DocName=report.item(""TypDoc"")",!
	Write " var idclass=report.ItemID;",!
	Write " if(ReturnSpace(idclass)=="""")return;",!
	Write " var arr=idclass.split(""@"")",!
	Write " if(arr.length>1){",!
	Write "	 WinResult=window.showModalDialog(""document.csp?silent=true"",arr[1]+InnerSplitter+arr[0]+InnerSplitter+DocName,""cener:yes;status:no;dialogHeight:600px;dialogWidth:600px;resizable:yes;"")",!
	Write "	 }",!
	Write " }",!
	Write " ",!
	Write "function load(){",!
	Write "depotelem.startDownload('Data.csp?class=Store.Depot&fields=ID,Name', put);",!
	Write "PropTable1.DownLoadPairs("""","""",""Dat,Tim,Summa,Name,DocumentClass,Stat,Source,User1,Depot,Comment,CloseDate,CloseTime,CloseUser"");",!
	Write "PropTable.DownLoadPairs("""","""",""Doc,DocType,Goods,Quantity,Price,Total,quantplan,Comment,kurs,dopperc"");",!
	Write "//typdocs.DownLoadPairs("""","""",""meas"");",!
	Write "Rep9SelectFn()",!
	Write "}",!
	Write " ",!
	Write "function put(textStr){",!
	Write "addOptions(textStr,""depotelem"");",!
	Write "var oOption = document.createElement(""OPTION"");",!
	Write "depotelem.options.add(oOption);",!
	Write "oOption.innerText = ""Все склады"";",!
	Write "oOption.value = """";",!
	Write "}",!
	Write !,"//отчет о приходе расходе",!
	Write "function show(){",!
	Write "var kontr=PropTable1.item(""Kontr"")",!
	Write "report.loadfrommethod(""Reports.Analyzis.prihrash"",dat1.value+""@""+dat2.value,depotelem.value,kontr)",!
	Write "rep1.checked=false;",!
	Write "}",!
	Write !,"//отчет об остатках",!
	Write "function showost(){",!
	Write "var addr=PropTable.item(""addr"");",!
	Write "rep2.checked=false;",!
	Write "report2.loadfrommethod(""Reports.Analyzis.ostatok"",addr)",!
	Write "}",!
	Write !,"//прогноз обнуления остатков",!
	Write "function shownull(){",!
	Write "rep3.checked=false;",!
	Write "report3.loadfrommethod(""Reports.Analyzis.nullost"",rep4dat1.value)",!
	Write "}",!
	Write !,"//показать документы по аттрибутам товара",!
	Write "function showdocs(){",!
	Write "if(goodspars==""""){alert(""Не установлены параметры товаров для отбора"");return}",!
	Write "rep4.checked=false;",!
	Write "report4.loadfrommethod(""Reports.Analyzis.docsbytovs"",rep4dat1.value+""@""+rep4dat2.value,goodspars,Rep4DocsSelector.value)",!
	Write "}",!
	Write !,"//показать документы по указанным аттрибутам",!
	Write "function showdocs2(){",!
	Write "if(docparams==""""){alert(""Не установлены параметры документов для отбора"");return}",!
	Write "rep5.checked=false;",!
	Write "report5.loadfrommethod(""Reports.Analyzis.docsbypars"",doctyp,docparams,rep5dat1.value+""@""+rep5dat2.value)",!
	Write "}",!
	Write !,"//показать скрыть ",!
	Write "function showhide(but){",!
	Write "var replist="""";",!
	Write "if(but==""rep1"")replist=""report"";",!
	Write "if(but==""rep2"")replist=""report2"";",!
	Write "if(but==""rep3"")replist=""report3"";",!
	Write "if(but==""rep4"")replist=""report4span"";",!
	Write "if(but==""rep5"")replist=""report5"";",!
	Write "if(but==""rep6"")replist=""report6"";",!
	Write "if(but==""rep7"")replist=""report7"";",!
	Write "if(but==""rep8"")replist=""report8"";",!
	Write "if(but==""rep9"")replist=""report9"";",!
	Write "if(but==""rep10"")replist=""report10"";",!
	Write "if(but==""rep11"")replist=""report11"";",!
	Write "if(replist=="""")return",!
	Write "if(document.getElementById(replist).style.display==""none""){document.getElementById(replist).style.display=""block"";}",!
	Write "else{document.getElementById(replist).style.display=""none"";}",!
	Write "}",!
	Write !,"function rep4help(){",!
	Write "goodspars=window.showModalDialog(""selgoodsparams.csp"","""",""center:yes;status:no;dialogHeight:370px;dialogWidth:600px;resizable:yes;"");",!
	Write "goodspars=ReturnSpace(goodspars);",!
	Write "}",!
	Write !,"//открыть карточку товара",!
	Write "function gcard(tovid){",!
	Write "	alert(tovid)",!
	Write "if(ReturnSpace(tovid)=="""")return",!
	Write "ok=window.showModalDialog(""GoodsCard.csp?GoodsId=""+tovid+""&groupspath=""+"""",tovid+InnerSplitter+"""",""center:yes;status:no;dialogHeight:600px;dialogWidth:650px;resizable:yes"")",!
	Write "}",!
	Write !,"// открыть окно с параметрами документа",!
	Write "function rep5params(){",!
	Write "doctyp=typDocsSel.value;",!
	Write "if(doctyp==""""){alert(""Не указан тип документа"");return}",!
	Write "docparams=window.showModalDialog(""seldocparams.csp?docclass=""+doctyp,"""",""center:yes;status:no;dialogHeight:600px;dialogWidth:650px;resizable:yes"")",!
	Write "docparams=ReturnSpace(docparams);",!
	Write "}",!
	Write !,"function showReport6(){",!
	Write "report6.loadfrommethod(""Reports.Analyzis.Zapchasti"",rep6dat1.value+""@""+rep6dat2.value,rep6models.value,rep6group.value)",!
	Write "}",!
	Write !,"//функция выбора контрагента (подставит выбранного в innerText переданного объекта",!
	Write "function ChooseKonragent(Obj){",!
	Write "newItem=window.showModalDialog(""Dictionary.csp"",""Common.Kontragent"",""center:yes;status:no;dialogHeight:400px;dialogWidth:650px;resizable:yes;"");",!
	Write "if(newItem==null){return false;}",!
	Write "var newArr=newItem.split(InnerSplitter);",!
	Write "Obj.innerText=newArr[1];",!
	Write "Obj.Tag=newArr[0];",!
	Write "}",!
	Write !,"function GoodsForRep7(){",!
	Write "WinResult=window.showModalDialog(""selectgoods2.csp"","""",""center:yes;status:no;dialogHeight:700px;dialogWidth:800px;resizable:yes;"")",!
	Write "if(WinResult==null)return",!
	Write "var TovarsString="""";",!
	Write "var IDsString="""";",!
	Write "var TovarsArray=WinResult.split(StringSplitter)",!
	Write "for(var i=0; i<TovarsArray.length-1; i++) ",!
	Write "	{",!
	Write "	var SingleTovarArray=TovarsArray[i].split(InnerSplitter)",!
	Write "	var IDsString=IDsString+"",""+SingleTovarArray[0];",!
	Write "	var TovarsString=TovarsString+"" ""+SingleTovarArray[8];",!
	Write "	}",!
	Write "Rep7TovarNames.innerText=TovarsString;",!
	Write "Rep7TovarNames.Tag=IDsString;",!
	Write "}",!
	Write !,"function showReport7(){",!
	Write "var Dates=rep7dat1.value+""@""+rep7dat2.value;",!
	Write "var TovarIDs=Rep7TovarNames.Tag",!
	Write "var KontrID=Kontr.Tag",!
	Write "report7.loadfrommethod(""Reports.Analyzis.OtpravkaKontragentu"",Dates,TovarIDs,KontrID)",!
	Write "}",!
	Write !,"function showReport8(){",!
	Write "var Dates=rep8dat1.value+""@""+rep8dat2.value;",!
	Write "report8.loadfrommethod(""Reports.Analyzis.ShowInactiveKontr"",Dates,"""","""")",!
	Write "}",!
	Write !,"//функции отчёта ""Прогноз остатков""",!
	Write "	function showReport9(){",!
	Write "		Dates=rep9dat1.value+""@""+rep9dat2.value;",!
	Write "		rep9.checked=false;",!
	Write "		RepTypeGoodsAbbr=Rep9Select.value+""@""+Rep9abbr.value;",!
	Write "		cspCallServerMethod('"_(..Encrypt($listbuild("Reports.Analyzis.NullOstatokForecastPrepare:csp.analyzis"))_$select(%session.UseSessionCookie'=2:"&CSPCHD="_%session.CSPSessionCookie,1:"")_"&WCHARSET="_%response.CharSet)_"',Dates,RepTypeGoodsAbbr,login)",!
	Write "		Rep9TimerID = window.setInterval(LookUpRep9, 2000)",!
	Write "	}",!
	Write !,"	function LookUpRep9(){",!
	Write "		var answer="_($case(%session.BrokerImplementation,1:"cspRunServerMethod",2:"cspHttpServerMethod",:"cspSelectServerMethod"))_"('"_(..Encrypt($listbuild("Reports.Analyzis.NullOstatokForecastLookUp:csp.analyzis"))_$select(%session.UseSessionCookie'=2:"&CSPCHD="_%session.CSPSessionCookie,1:""))_"',login)",!
	Write "		var command = answer.substr(0, 4);",!
	Write "		if(command==""stop"")",!
	Write "			{",!
	Write "			window.clearInterval(Rep9TimerID);",!
	Write "			report9.loadfrommethod(""Reports.Analyzis.NullOstatokForecastShow"",Dates,Rep9Select.value,login)",!
	Write "			var answer=answer.substr(4, answer.length);",!
	Write "			}",!
	Write "		Rep9Result.innerHTML=answer+""<br>"";",!
	Write "	}",!
	Write !,"	function Rep9SelectFn(){",!
	Write "		if(Rep9Select.value==""term""){var color=""#000000"";}",!
	Write "		else{var color=""#aaaaaa"";}",!
	Write "		Rep9Term.style.color=color;",!
	Write "		rep9dat1.style.color=color;",!
	Write "		rep9dat2.style.color=color;",!
	Write "	}",!
	Write !,"//Отчёт ""Контроль сроков обработки""",!
	Write "function showReport10(){",!
	Write "rep10.checked=false;",!
	Write "var Dates=rep10dat1.value+""@""+rep10dat2.value;",!
	Write "var Term=Rep10Select.value+""@""+rep10term.value;",!
	Write "var ShowAllInstr=Rep10checkbox.checked;",!
	Write "report10.loadfrommethod(""Reports.Analyzis.SendTermControl"",Dates,Term,ShowAllInstr)",!
	Write "if(ShowAllInstr){Rep10Legend.style.display=""block"";}",!
	Write "else{Rep10Legend.style.display=""none"";}",!
	Write "}",!
	Write !,"//Отчёт ""Запчасти которые требовал клиент и которые не были отправлены""",!
	Write "function showReport11()",!
	Write "{",!
	Write "	rep11.checked=false;",!
	Write "	var Dates=rep11dat1.value+""@""+rep11dat2.value;",!
	Write "	report11.loadfrommethod(""Reports.Analyzis.ShowGoodsZeroSent"",Dates,"""",login)",!
	Write "}",!
	Write !,"function showReport12(){",!
	Write "window.open(""Report12.csp?ContentType=""+rep12select.value+""&showdate=""+""rep12cb.checked""+""&Dat1=""+rep12dat1.value+""&Dat2=""+rep12dat2.value+""&sessionid=""+sessionid);",!
	Write "}",!
	Write !,"function showReport13(){",!
	Write "window.open(""Report13.csp?ContentType=""+rep13select.value+""&Dat1=""+rep13dat1.value+""&Dat2=""+rep13dat2.value+""&sessionid=""+sessionid);",!
	Write "}",!
	Write !,"function showReport14()",!
	Write "{",!
	Write "window.open(""Report14.csp?ContentType=""+rep14select.value+""&sessionid=""+sessionid+""&Rezerv=""+rep14Rezerv.checked+""&Catalogue=""+rep14CatalogueSelect.value);",!
	Write "}",!
	Write !,"function showReport15()",!
	Write "{",!
	Write "	var url = ""Report15.csp?ContentType=""+rep15select.value+""&sessionid=""+sessionid+""&Dat1=""+rep15dat1.value+""&Dat2=""+rep15dat2.value+""&State=""+rep15Select.value;",!
	Write "	window.open(url);",!
	Write "}",!
	Write "</script>"
	Write !,(..HyperEventHead())
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLADz XMLNS:SKLAD2 XMLNS:SKLADList>"
	Write !,"<IMPORT NAMESPACE=""SKLAD2"" IMPLEMENTATION=""htc/table.htc"">",!
	Write "<IMPORT NAMESPACE=""SKLADList"" IMPLEMENTATION=""htc/listview2.htc"">",!
	Do ..OnPageHEAD()
	Write !
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  s login=$G(%session.Data("user"))
  i '+login s %response.ServerSideRedirect="norights.csp" 
  i '##class(Common.Rights).getrights(login,17) s %response.ServerSideRedirect="norights.csp" 
  
  s YearBeginDate = "01/01/"_(+$ZD($H,3))
  q 1
 
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\analyzis.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/analyzis.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62177,86235</Default>
</Parameter>
</Class>
</Export>
