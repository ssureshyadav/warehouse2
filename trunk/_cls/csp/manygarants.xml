<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.manygarants">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62193,49991.300692</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""load();"" onkeypress=""ManageWindow();"">"
	Write !,"<p style=""font-face:Arial"" align=center>Множественный ввод номеров гарантийных талонов",!
	Write "<fieldset ><legend>Основные свойства</legend>",!
	Write "<SKLAD2:table id=""PropTable"" width=""100%"" />",!
	Write "</fieldset>",!
	Write "<table>",!
	Write "<tr><td colspan=2>Примечание к гарантийному талону:<br> "
	Write "<textarea id=""comment"" rows=4 cols=50>"
	Write "</textarea>"
	Write "<br><br>",!
	Write "<tr><td>Префикс номера гарантийного талона <td>"
	Write "<input id=""prefix"" type=text>"
	Write !,"<tr><td>Начальная цифра <td>"
	Write "<input id=""startnumb"" type=text>"
	Write " количество разрядов номера "
	Write "<input type=text id=""leng"" style=""width:40"">"
	Write !,"<tr><td colspan=2>Серийный и гарантийный номера идентичны "
	Write "<input type=""checkbox"" value=""1"" id=""SerialAsGarant"" style=""border:none;width:15"">"
	Write !,"<tr><td>Количество гарантийных талонов <td>"
	Write "<input id=""koli4est"" type=text value=1>"
	Write !,"</table>",!
	Write "<center><br>"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""startFun();"" TITLE=""""><center>Да</center></span>"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""window.close()"" TITLE=""""><center>Отмена</center></span>"
	Write "</center>",!
	Write "</table>",!
	Write "</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	s skip=%request.Get("skip")
	Write !
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<title>"_($G(%session.Data("systemname")))_"</title>",!
	Write "<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<script language=""Jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<script language=""JScript"">"
	Write !,"var argArr=window.dialogArguments.split("";"");",!
	Write "var ItemID=argArr[0];",!
	Write "var ClassName=argArr[1];",!
	Write !,"function startFun()",!
	Write "{",!
	Write "	if(ReturnSpace(ItemID)==""""){question=""Создать запись?""}",!
	Write "	else{question=""Изменить запись?""}",!
	Write "	if(!window.confirm(question))return false;",!
	Write "	var xmldoc=PropTable.GetXmlContent();",!
	Write "	xmldoc=addnode(xmldoc,""startnumb"",startnumb.value)",!
	Write "	xmldoc=addnode(xmldoc,""koli4est"",koli4est.value)",!
	Write "	xmldoc=addnode(xmldoc,""prefix"",prefix.value)",!
	Write "	xmldoc=addnode(xmldoc,""leng"",leng.value)",!
	Write "	xmldoc=addnode(xmldoc,""comment"",comment.value)",!
	Write "	if (SerialAsGarant.checked){ var SerialAsGarantValue = ""1""; }",!
	Write "	else{ var SerialAsGarantValue = ""0""; }",!
	Write "	xmldoc=addnode(xmldoc,""SerialAsGarant"",SerialAsGarantValue)",!
	Write "	",!
	Write "	//var xmldoc2=docstr.GetXmlContent();",!
	Write "	var ok=SplitSendXml("""",ClassName,xmldoc,"""","""_(%session.SessionId)_""",""Docs.Action.makealotgarants"");",!
	Write !,"	//alert(""первый""+isNaN(ok.substr(0, 1)) )",!
	Write "	if(!isNaN(ok.substr(0, 1))){returnValue=1;window.close();}",!
	Write "	else{alert(ok);}",!
	Write "}",!
	Write !,"function load()",!
	Write "{",!
	Write "	PropTable.DownLoadPairs(ClassName,ItemID,""remont1,remont2,remont3,remont1otch,remont2otch,remont3otch,Name,Dat,Comment"");",!
	Write "}",!
	Write !,"</script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLAD2>"
	Write !,"<IMPORT NAMESPACE=""SKLAD2"" IMPLEMENTATION=""htc/table.htc"" >",!
	Do ..OnPageHEAD()
	Write !
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\ManyGarants.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/ManyGarants.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>61935,5076</Default>
</Parameter>
</Class>
</Export>
