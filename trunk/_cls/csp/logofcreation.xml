<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.logofcreation">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62133,48457.791192</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body>"
	Write !," <font face=Arial>",!
	s doc=%request.Get("doc")
	s docObject=##class(Docs.StorageOut).%OpenId(doc)
	q:'$ISobject(docObject) 1
	s DocName=docObject.Name
	s DocDate=docObject.Dat
	s:DocDate DocDate=$ZD(DocDate,4)
	&html<
	<center>Протокол сборки инструкции по отгрузке №<b>#(DocName)#</b> от #(DocDate)#</center>
	<br><br>
	>
	s g=$NA(^LogOfCreation(doc))
	f  s g=$Q(@g) q:(g="")||($QS(g,1)'=doc)  d
	. if $QL(g)>=2,$G(OldGood)'=$QS(g,2) w "<hr width=80%>",!
	. f i=2:1:$QL(g) d
	. . w $QS(g,i)_" "
	. w $G(@g)_"<br>",!
	. s:$QL(g)>=2 OldGood=$QS(g,2)
	Write !,!,"</font>",!
	Write "</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<title>Журнал сборки инструкции по отбору</title>",!
	Write "</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html>"
	Write !
	Do ..OnPageHEAD()
	Write !
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\LogOfCreation.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/LogOfCreation.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>61018,35696</Default>
</Parameter>
</Class>
</Export>
