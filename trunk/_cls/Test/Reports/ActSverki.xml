<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="Test.Reports.ActSverki">
<Description>
Тестируем работу акта сверки</Description>
<Super>%UnitTest.TestCase</Super>
<TimeCreated>62409,68728.908419</TimeCreated>

<Method name="TestNew">
<Description>
Тестируем создание объекта акта сверки</Description>
<Implementation><![CDATA[
	 TSTART
		;нужен контрагент
		;нужна наша компания
		;нужен баланс контрагента
		;а для этого нужен документ прихода (товар, склад ячейка)
		s we=##class(Common.Kontragent).%New()
		s we.Name="Тестовый контрагент (мы сами) #1"
		s we.chief="Директор тестового контрагента №1"
		s we.Currency=1 ;этот считает в рублях
		s sc=we.%Save()
		s weId=we.%Id()
		w !,"We : ",we
		d $$$AssertEquals(sc,1,"Create test kontragent (we)")
		
		;этот будет считать в рублях
		s they=##class(Common.Kontragent).%New()
		s they.Name="Тестовый контрагент #2"
		s they.chief="Директор тестового контрагента №2"
		s they.Currency=2 ;баксы
		s sc=they.%Save()
		s theyId=they.%Id()
		w !,"They: ",they
		d $$$AssertEquals(sc,1,"Create test kontragent (they) ")
  
  s start=+$h,stop=start+1 ;период в сутки
  ;пробуем инициализацию
  s akt=##class(Reports.ActSverki).%New(weId,theyId,start,stop)
  d $$$AssertEquals(akt.we,weId,"Set owner")
  d $$$AssertEquals(akt.they,theyId,"Set kontragent")
  d $$$AssertEquals(akt.start,start,"Set start")
  d $$$AssertEquals(akt.stop,stop,"Set end")
  
  ;установка нас по контрагенту
  s akt=##class(Reports.ActSverki).%New(,theyId,start,stop)
  d $$$AssertEquals(akt.we,"","Empty owner")
  d $$$AssertEquals(akt.currency,2,"Set currency by kontragent")
  
  s they.OurCompany=we d they.%Save()
  s akt=##class(Reports.ActSverki).%New(,theyId,start,stop)
  d $$$AssertEquals(akt.we,weId,"Set owner by kontragent")
  
  
  
  
  
  
  TCOMMIT
]]></Implementation>
</Method>
</Class>
</Export>
