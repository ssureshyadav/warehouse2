<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.kontragentslistedit">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62024,3766.44617</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""FillDocStr();"" onkeypress=""ManageWindow();"">"
	Write !,"<table width=100% height=100%>",!
	Write "<tr height=95% valign=top><td>",!
	Write "	<SKLADiGrid:iGrid id=""docstr"" width=""100%"" height=""550"" Enabled=""true""  /><br>",!
	Write "</td></tr>",!
	Write "<tr height=5% valign=bottom><td>",!
	Write "	<center><br>"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"_($G(SaveButtonStyle))_""" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""startFun();"" TITLE=""""><center>Сохранить</center></span>"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""windowclose();"" TITLE=""""><center>Отмена</center></span>"
	Write "</center>",!
	Write "</tr></td>",!
	Write "</table>",!
	Write "</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !,!
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<title>Редактирование списка контрагентов</title>",!
	Write "<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !," "
	w "<script language=""jscript"">",!
	w "function InitFieldsArrays(){"
	s Fields="Name,Code,Address,EMail,Agree,chief,Status,Property2506,Activity,Region,City,Phones,ContPers,Federal"
	d ##class(Docs.Action2).ShowHeaders("Common.Kontragent",Fields,"docstr")
	w "}",!
	w "</"_"script>",!
	Write !,"<script language=""jscript"">"
	Write !,"var sessionid="""_(sessionid)_""";",!
	Write "var Where="""_(Where)_""";",!
	Write !,"function FillDocStr(){",!
	Write "InitFieldsArrays();",!
	Write "docstr.DrawHeaders(Captions,Keys,Tags, Widths, Combos);",!
	Write "docstr.loadfrommethod(""Docs.Action2.KontragentsList"",Where);",!
	Write "}",!
	Write !,"function startFun(){",!
	Write "xmlDoc=docstr.GetXmlContentByRows();",!
	Write "var ok=SendXml(1,""Common.Kontragent"",xmlDoc,sessionid);",!
	Write "if(isNaN(ok)){alert(ok)}",!
	Write "else{returnValue=1;window.close();}",!
	Write "}",!
	Write "</script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLADiGrid>"
	Write !,"<IMPORT NAMESPACE=""SKLADiGrid"" IMPLEMENTATION=""htc/iGridV7.htc"">",!
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  i %session.NewSession d
  . s %session.EndSession=1
  . s sessionid=%request.Get("sessionid",1)
  . s %session=%session.GetSession(sessionid)
  . s login=$G(%session.Data("user"))
  . //i '+login s %response.ServerSideRedirect="norights.csp" 
  e  s sessionid=%session.SessionId
  s Where=%request.Get("Where")
 Quit 1
 
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\KontragentsListEdit.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/KontragentsListEdit.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62024,3637</Default>
</Parameter>
</Class>
</Export>
