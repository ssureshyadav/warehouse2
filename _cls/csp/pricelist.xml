<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.pricelist">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<IncludeCode>xmlmacros</IncludeCode>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62126,52009.282459</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body lang=RU style='tab-interval:35.4pt'>"
	Write !,!,"<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=627",!
	Write " style='width:470.2pt;margin-left:4.65pt;border-collapse:collapse;mso-padding-alt:",!
	Write " 0cm 5.4pt 0cm 5.4pt;border-right:solid windowtext 1.0pt;'>",!
	Write " <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:21.0pt'>",!
	Write "  <td width=627 nowrap colspan=6 style='width:470.2pt;border:solid windowtext 1.0pt;",!
	Write "  border-right:solid black 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;height:21.0pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:16.0pt;font-family:""Arial CYR""'>"
	Write "Прайс-лист на запасные части"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write " </tr>",!
	Write " <tr style='mso-yfti-irow:1;height:13.5pt'>",!
	Write "  <td width=627 nowrap colspan=6 style='width:470.2pt;border-top:none;",!
	Write "  border-left:solid windowtext 1.0pt;border-bottom:solid windowtext 1.0pt;",!
	Write "  border-right:solid black 1.0pt;mso-border-top-alt:solid windowtext 1.0pt;",!
	Write "  padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "Цены",!
	Write "  указаны в у.е. с учетом НДС"
	Write "<span style='mso-spacerun:yes'>"
	Write "        ",!
	Write "  "
	Write "</span>"
	Write ($ZD(+$H,4))_"<o:p></o:p>"
	Write "</span>"
	Write "</p>",!
	Write "  </td>",!
	Write " </tr>",!
	Write " <tr style='mso-yfti-irow:2;height:13.5pt'>",!
	Write "  <td width=627 nowrap colspan=6 style='width:470.2pt;border:solid windowtext 1.0pt;",!
	Write "  border-top:none;mso-border-left-alt:solid windowtext 1.0pt;mso-border-bottom-alt:",!
	Write "  solid windowtext .5pt;mso-border-right-alt:solid windowtext 1.0pt;padding:",!
	Write "  0cm 5.4pt 0cm 5.4pt;height:18pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:16.0pt;font-family:""Arial CYR""'>"
	Write ($G(GroupName))
	Write "</span>"
	Write "</b><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write " </tr>",!
	Write " <tr style='mso-yfti-irow:3;height:13.5pt'>",!
	Write "  <td width=43 nowrap style='width:32.45pt;border:solid windowtext 1.0pt;",!
	Write "  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;",!
	Write "  padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "№ П/П<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write "  <td width=177 nowrap style='width:132.7pt;border-top:none;border-left:none;",!
	Write "  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;",!
	Write "  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;",!
	Write "  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "Изделие<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write "  <td width=119 nowrap style='width:89.25pt;border-top:none;border-left:none;",!
	Write "  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;",!
	Write "  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;",!
	Write "  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "Модель<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write "  <td width=160 nowrap style='width:119.7pt;border-top:none;border-left:none;",!
	Write "  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;",!
	Write "  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;",!
	Write "  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "Наименование запчасти<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write "  <td width=69 nowrap style='width:52.1pt;border-top:none;border-left:none;",!
	Write "  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;",!
	Write "  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;",!
	Write "  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "Код запчасти<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write "  <td width=59 nowrap style='width:44.0pt;border-top:none;border-left:none;",!
	Write "  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;",!
	Write "  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;",!
	Write "  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:13.5pt'>",!
	Write "  <p class=MsoNormal align=center style='text-align:center'><b>"
	Write "<span style='font-size:8.0pt;font-family:""Arial CYR""'>"
	Write "Цена за 1ед. $<o:p></o:p>"
	Write "</span>"
	Write "</b></p>",!
	Write "  </td>",!
	Write " </tr>",!
	Write " ",!
	Write " "
	s glob=$NA(^mtempReport("GetGoodsFromGroup",$I))
	s ok=##class(Reports.Analyzis).GetGoodsFromGroup(GroupCode,CatalogueID,glob)
	s GroupCode="" f  s GroupCode=$O(@glob@(GroupCode)) q:GroupCode=""  d
	. s GroupName=$G(@glob@(GroupCode,"GroupName"))
	. w "<tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;height:15pt'><td colspan=6 style=""border-left:solid windowtext 1.0pt;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;""><b><span style='font-size:13.0pt;font-family:Arial CYR'>"_GroupName_"</span></b></td></tr>"
	. s GoodsID="" f  s GoodsID=$O(@glob@(GroupCode,"Goods",GoodsID)) q:GoodsID=""  d
	. . i $I(count)
	. . s GroupID=$G(@glob@(GroupCode,"Goods",GoodsID,"GroupID"))
	. . s GoodsName=$G(@glob@(GroupCode,"Goods",GoodsID,"GoodsName"))
	. . s Goodsizdelie=$G(@glob@(GroupCode,"Goods",GoodsID,"Goodsizdelie"))
	. . s Goodsabbr=$G(@glob@(GroupCode,"Goods",GoodsID,"Goodsabbr"))
	. . s GoodsModel=$G(@glob@(GroupCode,"Goods",GoodsID,"GoodsModel"))
	. . s GoodsShemNumber=$G(@glob@(GroupCode,"Goods",GoodsID,"GoodsShemNumber"))
	. . s GoodsPrice=+$G(@glob@(GroupCode,"Goods",GoodsID,"GoodsPrice"))
	. . //разделитель дробной части в соответствии с настройками
	. . s GoodsPrice=$TR(GoodsPrice,".",$$$TunesVariableGlobal("DigitsDelimeter"))
	. . &html<<tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;height:12.75pt;'>
	<td width=43 nowrap valign=bottom style='width:32.45pt;border:solid windowtext 1.0pt;border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:12.75pt'>
	<p class=MsoNormal align=center style='text-align:center'><span  style='font-size:10.0pt;font-family:"Arial CYR"'>#(count)#<o:p></o:p></span></p>
	</td>
	<td width=177 nowrap valign=bottom style='width:132.7pt;border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;height:12.75pt'>
	<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Arial CYR"'>#(Goodsizdelie)#</span></p>
	</td>
	<td width=119 nowrap valign=bottom style='width:89.25pt;border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;height:12.75pt'>
	<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Arial CYR"'>#(Goodsabbr)#-#(GoodsModel)#<o:p></o:p></span></p>
	</td>
	<td width=160 nowrap valign=bottom style='width:119.7pt;border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;height:12.75pt'>
	<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Arial CYR"'>#(GoodsName)#<o:p></o:p></span></p>
	</td>
	<td width=69 nowrap valign=bottom style='width:52.1pt;border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;height:12.75pt'>
	<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Arial CYR"'>#(GoodsShemNumber)#<o:p></o:p></span></p>
	</td>
	<td valign=bottom style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;height:12.75pt' >
	<p class=MsoNormal align=right style='text-align:right'><span style='font-size:10.0pt;font-family:"Arial CYR"'>#(GoodsPrice)#</span></p>
	</td>
	</tr>
	>
	Write !,!,"</table>",!
	Write !,!,"</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !,!,!,!
	s GroupCode=%request.Get("GroupCode")
	s CatalogueID=%request.Get("CatalogueID")
	s GroupName=%request.Get("GroupName")
	Write !,!
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<meta http-equiv=Content-Type content=""text/html; charset=windows-1251"">"
	Write !,!,"<meta name=ProgId content=Word.Document>"
	Write !,"<meta name=Generator content=""Microsoft Word 11"">"
	Write !,"<meta name=Originator content=""Microsoft Word 11"">"
	Write !,"<title>Прайс лист "_($G(GroupName))_"</title>",!
	Write !,"<style>"
	Write !,"<!--",!
	Write " /* Font Definitions */",!
	Write " @font-face",!
	Write "	{font-family:""Arial CYR"";",!
	Write "	panose-1:2 11 6 4 2 2 2 2 2 4;",!
	Write "	mso-font-charset:204;",!
	Write "	mso-generic-font-family:swiss;",!
	Write "	mso-font-pitch:variable;",!
	Write "	mso-font-signature:536902279 -2147483648 8 0 511 0;}",!
	Write " /* Style Definitions */",!
	Write " p.MsoNormal, li.MsoNormal, div.MsoNormal",!
	Write "	{mso-style-parent:"""";",!
	Write "	margin:0cm;",!
	Write "	margin-bottom:.0001pt;",!
	Write "	mso-pagination:widow-orphan;",!
	Write "	font-size:12.0pt;",!
	Write "	font-family:""Times New Roman"";",!
	Write "	mso-fareast-font-family:""Times New Roman"";}",!
	Write "p.MsoHeader, li.MsoHeader, div.MsoHeader",!
	Write "	{margin:0cm;",!
	Write "	margin-bottom:.0001pt;",!
	Write "	mso-pagination:widow-orphan;",!
	Write "	tab-stops:center 233.85pt right 467.75pt;",!
	Write "	font-size:12.0pt;",!
	Write "	font-family:""Times New Roman"";",!
	Write "	mso-fareast-font-family:""Times New Roman"";}",!
	Write "p.MsoFooter, li.MsoFooter, div.MsoFooter",!
	Write "	{margin:0cm;",!
	Write "	margin-bottom:.0001pt;",!
	Write "	mso-pagination:widow-orphan;",!
	Write "	tab-stops:center 233.85pt right 467.75pt;",!
	Write "	font-size:12.0pt;",!
	Write "	font-family:""Times New Roman"";",!
	Write "	mso-fareast-font-family:""Times New Roman"";}",!
	Write " /* Page Definitions */",!
	Write " @page",!
	Write "	{mso-mirror-margins:yes;",!
	Write "	mso-footnote-separator:url(""Прайс.files/header.htm"") fs;",!
	Write "	mso-footnote-continuation-separator:url(""Прайс.files/header.htm"") fcs;",!
	Write "	mso-endnote-separator:url(""Прайс.files/header.htm"") es;",!
	Write "	mso-endnote-continuation-separator:url(""Прайс.files/header.htm"") ecs;}",!
	Write "@page Section1",!
	Write "	{size:595.3pt 841.9pt;",!
	Write "	margin:2.0cm 2.0cm 2.0cm 2.0cm;",!
	Write "	mso-header-margin:17.0pt;",!
	Write "	mso-footer-margin:35.45pt;",!
	Write "	mso-paper-source:0;}",!
	Write "div.Section1",!
	Write "	{page:Section1;}",!
	Write "-->"
	Write !,"</style>"
	Write !,"<!--[if gte mso 10]>",!
	Write "<style>",!
	Write " /* Style Definitions */",!
	Write " table.MsoNormalTable",!
	Write "	{mso-style-name:""Обычная таблица"";",!
	Write "	mso-tstyle-rowband-size:0;",!
	Write "	mso-tstyle-colband-size:0;",!
	Write "	mso-style-noshow:yes;",!
	Write "	mso-style-parent:"""";",!
	Write "	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;",!
	Write "	mso-para-margin:0cm;",!
	Write "	mso-para-margin-bottom:.0001pt;",!
	Write "	mso-pagination:widow-orphan;",!
	Write "	font-size:10.0pt;",!
	Write "	font-family:""Times New Roman"";",!
	Write "	mso-ansi-language:#0400;",!
	Write "	mso-fareast-language:#0400;",!
	Write "	mso-bidi-language:#0400;}",!
	Write "</style>",!
	Write "<![endif]-->"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html>"
	Write !,!
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,!,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  i %session.NewSession d
  . s %session.EndSession=1
  . s sessionid=%request.Get("sessionid",1)
  . s %session=%session.GetSession(sessionid)
  .  s login=$G(%session.Data("user"))
  . i '+login s %response.ServerSideRedirect="norights.csp" 
  e  s sessionid=%session.SessionId
  
 Quit 1
 
]]></Implementation>
</Method>

<Parameter name="CHARSET">
<Default>windows-1251</Default>
</Parameter>

<Parameter name="CONTENTTYPE">
<Default>text/html</Default>
</Parameter>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\pricelist.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/pricelist.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62074,45305</Default>
</Parameter>
</Class>
</Export>
