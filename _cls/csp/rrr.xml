<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.rrr">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62173,61231.927203</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body>"
	Write !,!,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""window.location.href='analyzis.csp';"" TITLE=""""><center>Назад</center></span>"
	Write "<br>",!
	Write "<TABLE cellSpacing=0 width=""100%"" celpadding=""0"" >",!
	Write "<TR>",!
	Write "<TD align=center style=""BACKGROUND: rgb(233,243,255); FONT-size: 18px ; font-family: arial; COLOR: rgb(0,0,102); BORDER-BOTTOM: rgb(0,0,102) 1px solid"" colspan=3><strong>Расход по брендам</strong></TD></tr>",!
	Write "<tr>",!
	Write "</table>",!
	Write !,"<form name=""forma"">"
	Write !,..InsertHiddenFields(""),!
	Write "Дата начала"
	Write "<input type=text name=data id=data onclick=""DateClick(this)"">"
	Write "<br>",!
	Write "Дата окончания"
	Write "<input type=text name=data2 id=data2 onclick=""DateClick2(this)"">"
	Write "<br>",!
	Write " "
	Write "<input type=button onclick=""subm()"" value=""ok"" style=""width:30"">"
	Write !," "
	Write "<input type=hidden name=ki value=1>"
	Write !," "
	Write "</form>"
	Write !
	s dat1=$G(%request.Data("data",1))
	s dat2=$G(%request.Data("data2",1))
	s ki=$G(%request.Data("ki",1))
	q:ki'=1
	w "<h4>сумма расходных накладных посчитанных по цене из товарного справочника с "_dat1_" по "_dat2_"</h4><br>"
	s dat1=$ZDH(dat1,4)
	s dat2=$ZDH(dat2,4)
	&sql(DECLARE C1 CURSOR FOR
	SELECT ID
	INTO :ID
	FROM Docs.Rash
	where Dat>=:dat1 and Dat<=:dat2)
	&sql(open C1)
	k res
	f  &sql(fetch C1) q:SQLCODE  d
	. i $I(count)
	. s ok=##class(Docs.Action).GetSummByPrice("Docs.Rash",ID,.mummy)
	. i '+ok w ok_"<br>"
	. s i="" f  s i=$O(mummy("code",i)) q:i=""  d
	. . s res(i)=$G(res(i))+$G(mummy("code",i))
	. . s res=$G(res)+$G(mummy)
	&sql(close C1)
	w "всего обработано документов: "_count
	w "<br>"
	s i="" f  s i=$O(res(i)) q:i=""  d
	. w i_" = "_$G(res(i))_"<br>"
	w "итого: "_$G(res)
	Write !,!,"</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,!,"<!-- Put your page Title here -->"
	Write !,"<title>	Cache Server Page </title>",!
	Write "<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<style>"
	Write !,"body{font-face: arial; font-size: 14}",!
	Write "</style>"
	Write !,"<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !,!,"<script language=""Jscript"">"
	Write !,"function DateClick(koko){",!
	Write "newDate=window.showModalDialog(""calendar.csp"","""",""center:yes;status:no;dialogHeight:350px;dialogWidth:310px;resizable:yes;"");",!
	Write "if(ReturnSpace(newDate)!=""""){document.all.data.value=newDate;}",!
	Write "}",!
	Write !,"function DateClick2(koko){",!
	Write "newDate=window.showModalDialog(""calendar.csp"","""",""center:yes;status:no;dialogHeight:350px;dialogWidth:310px;resizable:yes;"");",!
	Write "if(ReturnSpace(newDate)!=""""){document.all.data2.value=newDate;}",!
	Write "}",!
	Write !,"function subm(){",!
	Write "if(document.all.data.value==""""){",!
	Write "	DateClick()",!
	Write "}",!
	Write "else{",!
	Write "	forma.submit();",!
	Write "}",!
	Write "}",!
	Write "</script>"
	Write !,!,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html>"
	Write !
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\rrr.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/rrr.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62173,61232</Default>
</Parameter>
</Class>
</Export>
