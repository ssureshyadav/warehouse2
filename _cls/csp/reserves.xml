<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.reserves">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>61227,46434.339526</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""load('','')"">"
	Write !,!,"<span class=ButtonDiv style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""window.location.href='goods.csp'"" ><center>Назад</center></span>"
	Write "<br>",!
	Write !,"<TABLE cellSpacing=0 width=""100%"" celpadding=""0"" >",!
	Write "<TR>",!
	Write "<TD align=center style=""BACKGROUND: rgb(233,243,255); FONT-size: 18px ; font-family: arial; COLOR: rgb(0,0,102); BORDER-BOTTOM: rgb(0,0,102) 1px solid"" colspan=3><strong>Резервы</strong></TD></tr>",!
	Write "<tr>",!
	Write "</table>",!
	Write "<br>",!
	Write !,"<span class=ButtonDiv style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""window.location.reload()"" ><center>Обновить</center></span>"
	Write !,"<br>",!
	Write "<span id=""namfld"">"
	Write "</span>"
	Write "&nbsp;"
	Write "<input type=""text"" id=""fldval"" onkeyup=""gg();"">"
	Write !,"<SKLADList:listview width=100% height=150 id=""currentdict"" zonColumnClick=""colclick()"" /><br>",!
	Write !,"<img src=""images/card.gif"" onmouseover=""cardtov.src='images/Oncard.gif'"" onmouseout=""cardtov.src='images/card.gif'""  id=""cardtov"" name=""cardtov"" alt=""Карточка товара"" onclick=""OpenCard()"" style="""">"
	Write !,!,"<img src=""images/print.gif"" onmouseover=""okbwut2.src='images/Onprint.gif'"" onmouseout=""okbwut2.src='images/print.gif'""  id=""okbwut2"" name=""okbwut2"" alt=""Печать документа"" onclick=""prnt()"" style="""">"
	Write !,"</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<title>	Cache Server Page </title>",!
	Write "<Script language=""Jscript"">"
	Write !,"sessionid="""_(%session.SessionId)_""";",!
	Write "var ColCode="""";",!
	Write "function gg(){",!
	Write "if(ColCode=="""")return false;",!
	Write "var SearchProperty = ColCode;",!
	Write "var SearchValue = fldval.value;",!
	Write "if(SearchValue=="""")SearchProperty="""";",!
	Write "load(SearchProperty,SearchValue);",!
	Write "}",!
	Write !,"function colclick(){",!
	Write "	if(currentdict.ColType==""%Date""){alert(""Поля с датами не обрабатываются"");return false;}",!
	Write "	namfld.innerText=currentdict.ColName;",!
	Write "	ColCode=currentdict.ColCode;",!
	Write "}",!
	Write !,!,"function load(SearchProperty,SearchValue){",!
	Write "currentdict.loadfrommethod(""Reports.ShowTables.ShowReserves"",SearchProperty,SearchValue,"""");",!
	Write "}",!
	Write !,"function prnt(docid,docclass){",!
	Write "var docid=currentdict.ItemID;",!
	Write "var docid=docid.split(""@"")[1];",!
	Write "if(docid=="""")return",!
	Write "window.open(""print.csp?id=""+docid+""&class=Docs.StorageOut""+""&sessionid=""+sessionid)",!
	Write "}",!
	Write !,"//Открыть карточку товара",!
	Write "function OpenCard(){",!
	Write "var GoodsId=currentdict.ItemID;",!
	Write "var GoodsId=GoodsId.split(""@"")[0];",!
	Write "if(GoodsId=="""")return",!
	Write "ok=window.showModalDialog(""GoodsCard.csp?GoodsId=""+GoodsId+""&groupspath="",GoodsId+InnerSplitter+"""",""center:yes;status:no;dialogHeight:600px;dialogWidth:650px;resizable:yes"")",!
	Write "}",!
	Write !,"</Script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLADList>"
	Write !,"<IMPORT NAMESPACE=""SKLADList"" IMPLEMENTATION=""htc/listview.htc"">",!
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\Reserves.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/Reserves.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>61206,42470</Default>
</Parameter>
</Class>
</Export>
