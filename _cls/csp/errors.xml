<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.errors">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62187,46539.022291</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body>"
	Write !,!
	If '(data="") Goto %csp00001 ;{
	Write !,"<center><h2>Ошибки</h2></center>",!
	Write "<form name=""forma"">"
	Write !,..InsertHiddenFields(""),!
	Write "Дата "
	Write "<input type=text value="_($ZD(+$H,4))," name=data id=data onclick=""DateClick()"">"
	Write " "
	Write "<input type=button onclick=""subm()"" value=""ok"" style=""width:30"">"
	Write "</form>"
	Write !
	Goto %csp00002 ;}
%csp00001	;{
	Write !,"<a href="""_(..EscapeHTML(..Link("error.csp")))_""">"
	Write "выбрать дату"
	Write "</a>"
	Write "<br>",!
	Write "ошибки на дату "_(data),!
	Write "<table border=1><tr><td>Дата, время<td>Содержание ошибки<td>Уточнение",!
	s datah=$ZDH(data,4)
	s i="" f  s i=$O(^Errors(i)) q:i=""  d
	. q:+i'=datah
	. s f="" f  s f=$O(^Errors(i,f)) q:f=""  d
	. . s value=$G(^Errors(i,f))
	. . s value=$TR(value,"<","(")
	. . s value=$TR(value,">",")")
	. . w "<tr><td>"_$ZDT(i,4)_"<td>"_value_"<td>"_f
	Write !,"</table>",!
%csp00002	;}
	Write !,"</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	s data=$G(%request.Data("data",1))
	Write !
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<title>Ошибки</title>",!
	Write "<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<style>"
	Write !,"body{font-face: arial; font-size: 14}",!
	Write "</style>"
	Write !,"<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<script language=""Jscript"">"
	Write !,"function DateClick(){",!
	Write "newDate=window.showModalDialog(""calendar.csp"","""",""center:yes;status:no;dialogHeight:350px;dialogWidth:310px;resizable:yes;"");",!
	Write "if(ReturnSpace(newDate)!=""""){document.all.data.value=newDate;}",!
	Write "}",!
	Write "function subm(){",!
	Write "if(document.all.data.value==""""){",!
	Write "	DateClick()",!
	Write "}",!
	Write "else{",!
	Write "	forma.submit();",!
	Write "}",!
	Write "}",!
	Write "</script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html>"
	Write !
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\errors.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/errors.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>60942,71250</Default>
</Parameter>
</Class>
</Export>
