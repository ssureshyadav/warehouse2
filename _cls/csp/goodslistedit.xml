<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.goodslistedit">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62024,3775.787922</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""FillDocStr();"" onkeypress=""ManageWindow();"">"
	Write !,"<table width=100% height=100%>",!
	Write "<tr height=95% valign=top><td>",!
	Write "	<SKLADiGrid:iGrid id=""docstr"" width=""100%"" height=""550"" Enabled=""true""  /><br>",!
	Write "</td></tr>",!
	Write "<tr height=5% valign=bottom><td>",!
	Write "	<center><br>"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"_($G(SaveButtonStyle))_""" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""startFun();"" TITLE=""""><center>Сохранить</center></span>"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""windowclose();"" TITLE=""""><center>Отмена</center></span>"
	Write "</center>",!
	Write "</tr></td>",!
	Write "</table>",!
	Write "</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !,!
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<title>Редактирование списка товаров</title>",!
	Write "<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<script language=""jscript"">"
	Write !,"var sessionid="""_(sessionid)_""";",!
	Write "var Where="""_(Where)_""";",!
	Write !,"function FillDocStr(){",!
	Write "var Captions = new Array(8);",!
	Write "var Keys = new Array(8);",!
	Write "var Tags = new Array(8);",!
	Write "var Widths = new Array(8);",!
	Write !,"Captions[0]=""Аббревиатура"";",!
	Write "Captions[1]=""Модель"";",!
	Write "Captions[2]=""Наименование"";",!
	Write "Captions[3]=""Английское наименование"";",!
	Write "Captions[4]=""Вес"";",!
	Write "Captions[5]=""Объём"";",!
	Write "Captions[6]=""Код детали"";",!
	Write "Captions[7]=""Номер по схеме"";",!
	Write !,"Tags[0]=""%String"";",!
	Write "Tags[1]=""%String"";",!
	Write "Tags[2]=""%String"";",!
	Write "Tags[3]=""%String"";",!
	Write "Tags[4]=""%String"";",!
	Write "Tags[5]=""%String"";",!
	Write "Tags[6]=""%String"";",!
	Write "Tags[7]=""%String"";",!
	Write !,"Keys[0]=""abbr"";",!
	Write "Keys[1]=""Property3609"";",!
	Write "Keys[2]=""Name"";",!
	Write "Keys[3]=""EnglishName"";",!
	Write "Keys[4]=""Weight"";",!
	Write "Keys[5]=""Size1"";",!
	Write "Keys[6]=""codedetail"";",!
	Write "Keys[7]=""Property5300"";",!
	Write !,"Widths[0]=70;",!
	Write "Widths[1]=70;",!
	Write "Widths[2]=230;",!
	Write "Widths[3]=230;",!
	Write "Widths[4]=60;",!
	Write "Widths[5]=60;",!
	Write "Widths[6]=100;",!
	Write "Widths[7]=100;",!
	Write "docstr.DrawHeaders(Captions,Keys,Tags, Widths);",!
	Write "docstr.loadfrommethod(""Goods.GoodsAction.GoodsList"",Where);",!
	Write "}",!
	Write !,"function startFun(){",!
	Write "xmlDoc=docstr.GetXmlContentByRows();",!
	Write "var ok=SendXml(1,""Goods.Goods"",xmlDoc,sessionid);",!
	Write "if(isNaN(ok)){alert(ok)}",!
	Write "else{returnValue=1;window.close();}",!
	Write "}",!
	Write "</script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLADiGrid>"
	Write !,"<IMPORT NAMESPACE=""SKLADiGrid"" IMPLEMENTATION=""htc/iGridV7.htc"">",!
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  i %session.NewSession d
  . s %session.EndSession=1
  . s sessionid=%request.Get("sessionid",1)
  . s %session=%session.GetSession(sessionid)
  . s login=$G(%session.Data("user"))
  . i '+login s %response.ServerSideRedirect="norights.csp" 
  e  s sessionid=%session.SessionId
  s Where=%request.Get("Where")
 Quit 1
 
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\GoodsListEdit.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/GoodsListEdit.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62024,3620</Default>
</Parameter>
</Class>
</Export>
