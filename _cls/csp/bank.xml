<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.bank">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62171,31998.542446</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body onload=""load();"" onkeypress=""ManageWindow();"">"
	Write !,!,"<center><font size=+1 color=""#334455"">"_($G(kname))_"</font></center>",!
	Write "<table>",!
	Write "<form name=""ss"">"
	Write !,..InsertHiddenFields(""),!
	Write "<input type=""hidden"" name=""kontragent"" value="""_($G(Kontr))_""">"
	Write !,"<tr><td>Банк получателя</td><td>"
	Write "<input type=""text"" value="""_($G(pbank))_""" name=""pbank"">"
	Write "</td></tr>",!
	Write "<tr><td>Город банка получателя</td><td>"
	Write "<input type=""text"" value="""_($G(city))_""" name=""city"">"
	Write "</td></tr>",!
	Write "<tr><td>КПП</td><td>"
	Write "<input type=""text"" value="""_($G(kpp))_""" name=""kpp"">"
	Write "</td></tr>",!
	Write "<tr><td>ИНН</td><td>"
	Write "<input type=""text"" value="""_($G(inn))_""" name=""inn"">"
	Write "</td></tr>",!
	Write "<tr><td>БИК</td><td>"
	Write "<input type=""text"" value="""_($G(bik))_""" name=""bik"">"
	Write "</td></tr>",!
	Write "<tr><td>ОКПО</td><td>"
	Write "<input type=""text"" value="""_($G(okpo))_""" name=""okpo"">"
	Write "</td></tr>",!
	Write "<tr><td>ОКУД</td><td>"
	Write "<input type=""text"" value="""_($G(okud))_""" name=""okud"">"
	Write "</td></tr>",!
	Write "<tr><td>ОКДП</td><td>"
	Write "<input type=""text"" value="""_($G(okdp))_""" name=""okdp"">"
	Write "</td></tr>",!
	Write "<tr><td>ОКОНХ</td><td>"
	Write "<input type=""text"" value="""_($G(okonh))_""" name=""okonh"">"
	Write "</td></tr>",!
	Write "<tr><td>Расчетный счёт</td><td>"
	Write "<input type=""text"" value="""_($G(rsch))_""" name=""rsch"">"
	Write "</td></tr>",!
	Write "<tr><td>Корреспондетский счёт</td><td>"
	Write "<input type=""text"" value="""_($G(ksch))_""" name=""ksch"">"
	Write "</td></tr>",!
	Write "<tr><td>Код банка</td><td>"
	Write "<input type=""text"" value="""_($G(code))_""" name=""code"">"
	Write "</td></tr>",!
	Write "<tr><td>ОГРН</td><td>"
	Write "<input type=""text"" value="""_($G(ogrn))_""" name=""ogrn"">"
	Write "</td></tr>",!
	Write "<tr><td>ОКАТО</td><td>"
	Write "<input type=""text"" value="""_($G(okato))_""" name=""okato"">"
	Write "</td></tr>",!
	Write "<tr><td>Свидетельство о регистрации</td><td>"
	Write "<input type=""text"" value="""_($G(regnumber))_""" name=""regnumber"">"
	Write "</td></tr>",!
	Write "<input type=""hidden"" value="""_($G(sessionid))_""" name=""sessionid"">"
	Write !,"</form>"
	Write !,"</table>",!
	Write "<center>",!
	If '(Access10func=1) Goto %csp00001 ;{
	Write "	",!
	Write "	"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""startFun();"" TITLE=""""><center>Да</center></span>"
	Write !
%csp00001	;}
	Write !,!,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""windowclose()"" TITLE=""""><center>Отмена</center></span>"
	Write "</center>",!
	Write "</table>",!
	Write "</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !
	s Kontr=%request.Get("Kontr")
	s kontragent=%request.Get("kontragent")
	d:kontragent'=""
	. s start="window.close()"
	. q:'Access10func
	. s k=##class(Common.Kontragent).%OpenId(kontragent)
	. d:$ISOBJECT(k)
	. . s k.bank.pbank=%request.Get("pbank")
	. . s k.bank.city=%request.Get("city")
	. . s k.bank.kpp=%request.Get("kpp")
	. . s k.bank.inn=%request.Get("inn")
	. . s k.bank.bik=%request.Get("bik")
	. . s k.bank.rsch=%request.Get("rsch")
	. . s k.bank.ksch=%request.Get("ksch")
	. . s k.bank.code=%request.Get("code")
	. . s k.bank.okpo=%request.Get("okpo")
	. . s k.bank.okud=%request.Get("okud")
	. . s k.bank.okdp=%request.Get("okdp")
	. . s k.bank.okonh=%request.Get("okonh")
	. . s k.bank.ogrn=%request.Get("ogrn")
	. . s k.bank.okato=%request.Get("okato")
	. . s k.bank.regnumber=%request.Get("regnumber")
	. . d k.%Save()
	s k=##class(Common.Kontragent).%OpenId(Kontr)
	d:$ISOBJECT(k)
	. s kname=k.Name
	. s bank=k.bank
	. d:$ISOBJECT(bank)
	. . s pbank=bank.pbank
	. . s city=bank.city
	. . s kpp=bank.kpp
	. . s inn=bank.inn
	. . s bik=bank.bik
	. . s rsch=bank.rsch
	. . s ksch=bank.ksch
	. . s code=bank.code
	. . s okpo=bank.okpo
	. . s okud=bank.okud
	. . s okdp=bank.okdp
	. . s okonh=bank.okonh
	. . s ogrn=bank.ogrn
	. . s okato=bank.okato
	. . s regnumber=bank.regnumber
	Write !
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<style>"
	Write !,"input{border:solid 1 grey;width:250px}",!
	Write "</style>"
	Write !,"<title>"_($G(%session.Data("systemname")))_"</title>",!
	Write "<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<script language=""Jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<script language=""JScript"">"
	Write !,!,"function startFun(){",!
	Write ($G(Func10Refuse)),!
	Write "ss.submit();",!
	Write "window.close();",!
	Write "}",!
	Write !,"function load(){",!
	Write ($G(start)),!
	Write "}",!
	Write !,"</script>"
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLAD2 XMLNS:SKLADList>"
	Write !,"<IMPORT NAMESPACE=""SKLAD2"" IMPLEMENTATION=""htc/table.htc"">",!
	Write "<IMPORT NAMESPACE=""SKLADList"" IMPLEMENTATION=""htc/listview2.htc"">",!
	Do ..OnPageHEAD()
	Write !
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  i %session.NewSession d
  . s %session.EndSession=1
  . s sessionid=%request.Get("sessionid",1)
  . s %session=%session.GetSession(sessionid)
  e  s sessionid=%session.SessionId
  s login=$G(%session.Data("user"))
  i '+login s %response.ServerSideRedirect="norights.csp" 
  s Access10func=##class(Common.Rights).getrights($G(login,0),10)
  if 'Access10func s Func10Refuse="return;"
 Quit 1
 
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\bank.csp</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/bank.csp</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62164,41528</Default>
</Parameter>
</Class>
</Export>
