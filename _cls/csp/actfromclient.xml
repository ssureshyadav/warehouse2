<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="20">
<Class name="csp.actfromclient">
<ClassType/>
<Hidden>1</Hidden>
<Import>User</Import>
<Language>cache</Language>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeCreated>62194,40894.996943</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	Do ..OnPageCSPROOT()
	Quit $$$OK
]]></Implementation>
</Method>

<Method name="OnPageBODY">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<body>"
	Write !,!
	s DocId=+%request.Get("docid")
	s Kontr=325
	s KontrName="Проверочный пользователь"
	s Tovar = 15549  
	s TovarName="MAG-1117 выключатель"
	Write !,"<br><br>",!
	Write "<fieldset><legend>Общие данные документа</legend>",!
	Write "<table class=""LeftTop"" cellspacing=0 width=100%>",!
	Write "<tr>",!
	Write "	<td class=RightBottom>Дата<td class=RightBottom>"
	Write "<input type=text id=""InstDate"" value="""_($ZD($G(InstDate,$H),4))_""" onclick=""fnCalendar(this)"" class=""datar"" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"">"
	Write !,"	<td class=RightBottom>Контрагент<td class=RightBottom>"
	Write "<span onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" class=""Kontragent"" onclick=""ChooseKonragent(this)"" oncontextmenu=""this.innerText='';this.Tag=''"" id=""Kontr"" Tag="""_($G(Kontr))_""">"
	Write ($G(KontrName))
	Write "</span>"
	Write !,"</tr>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Товар оставлен на ответственное хранение<td class=RightBottom>"
	Write "<input type=""checkbox"" value=""1"">"
	Write !,"	<td class=RightBottom>Дата составления акта<td class=RightBottom>"
	Write "<input type=text id=""InstDate"" value="""_($ZD($G(InstDate,$H),4))_""" onclick=""fnCalendar(this)"" class=""datar"" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"">"
	Write !,"</tr>",!
	Write "</table>",!
	Write "</fieldset>",!
	Write !,"<br><br>",!
	Write !,"<fieldset><legend>Товар</legend>",!
	Write "<table class=""LeftTop"" cellspacing=0 width=100%>",!
	Write "<tr>",!
	Write "	<td class=RightBottom>Товар<td class=RightBottom>"
	Write "<span onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"" class=""Kontragent"" onclick=""ChooseTovar(this)"" oncontextmenu=""this.innerText='';this.Tag=''"" id=""Tovar"" Tag="""_($G(Tovar))_""">"
	Write ($G(TovarName))
	Write "</span>"
	Write !,"	<td colspan=2 class=RightBottom>&nbsp;",!
	Write "</tr>",!
	Write "<tr>",!
	Write "	<td class=RightBottom>Серийный номер<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"	<td class=RightBottom>Гарантийный номер<td class=RightBottom>"
	Write "<input type=text id=""Garant"" MAXLENGTH=50 Value="""_($G(Garant))_""">"
	Write !,"</tr>",!
	Write "</table>",!
	Write "</fieldset><br><br>",!
	Write !,"<fieldset><legend>Продавец</legend>",!
	Write "<!-- поправить имена контролов -->"
	Write !,"<table class=""LeftTop"" cellspacing=0 width=100%>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Наименование продавца<td class=RightBottom>"
	Write "<input type=text id=""SellerName"" MAXLENGTH=50 value="""_($G(SellerName))_""">"
	Write !,"	<td class=RightBottom>Адрес продавца<td class=RightBottom>"
	Write "<input type=text id=""SellerAddress"" MAXLENGTH=50 value="""_($G(SellerAddress))_""">"
	Write !,"</tr>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Телефон продавца<td class=RightBottom>"
	Write "<input type=text id=""SellerPhone"" MAXLENGTH=50 value="""_($G(SellerPhone))_""">"
	Write !,"	<td class=RightBottom>Дата продажи<td class=RightBottom>"
	Write "<input type=text id=""SellerDate"" value="""_($ZD($G(SellerDate,$H),4))_""" onclick=""fnCalendar(this)"" class=""datar"" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"">"
	Write !,"</tr>",!
	Write "</table>",!
	Write "</fieldset><br><br>",!
	Write !,"<fieldset><legend>Сервисный центр</legend>",!
	Write "<!-- поправить имена контролов -->"
	Write !,"<table class=""LeftTop"" cellspacing=0 width=100%>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Дата осмотра<td class=RightBottom>"
	Write "<input type=text id=""ExpertDate"" value="""_($ZD($G(ExpertDate,$H),4))_""" onclick=""fnCalendar(this)"" class=""datar"" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"">"
	Write !,"	<td class=RightBottom>Дата поступления в ремонт<td class=RightBottom>"
	Write "<input type=text id=""RemontDate"" value="""_($ZD($G(RemontDate,$H),4))_""" onclick=""fnCalendar(this)"" class=""datar"" onmouseout=""UnPaint(this)"" onmouseover=""Paint(this)"">"
	Write !,"</tr>",!
	Write !,"<tR>",!
	Write "	<td class=RightBottom>Количество ремонтов<td class=RightBottom>"
	Write "<input type=text id=""RepairsQnt"" MAXLENGTH=50 value="""_($G(RepairsQnt))_""">"
	Write !,"	<td class=RightBottom>Классификация дефекта<td class=RightBottom>",!
	Write "		"
	Write "<select id=""DefectClass"">"
	Write !,"			"
	w ##class(Docs.Action2).GetDisplaylistOptions($G(DefectClass),"Docs.Act||DefectClass")
	Write !,"		"
	Write "</select>"
	Write !,"</tr>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Описание неисправности<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"	<td class=RightBottom>Предполагаемая причина<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"</tr>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Причина отказа в ремонте<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"	<td class=RightBottom>Заявка по которой не поступили запчасти<td class=RightBottom>",!
	Write "</tr>",!
	Write "</table>",!
	Write "</fieldset><br><br>",!
	Write !,"<fieldset><legend>Потребитель</legend>",!
	Write "<!-- поправить имена контролов -->"
	Write !,"<table class=""LeftTop"" cellspacing=0 width=100%>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>ФИО потребителя<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"	<td class=RightBottom>Паспортные данные<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"</tr>",!
	Write "<tR>",!
	Write "	<td class=RightBottom>Телефон потребителя<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"	<td class=RightBottom>Контактные данные<td class=RightBottom>"
	Write "<input type=text id=""Serial"" MAXLENGTH=50 value="""_($G(Serial))_""">"
	Write !,"</tr>",!
	Write "</table>",!
	Write "</fieldset>",!
	Write !,"<center><br>",!
	Write !
	If '(DocId=0) Goto %csp00001 ;{
	Write !,"	"
	Write !,"<span class=ButtonDiv ID="""" style=""cursor:hand;"_($G(SaveButtonStyle))_""" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""startFun();"" TITLE=""""><center>Сохранить</center></span>"
	Write !
%csp00001	;}
	Write !,!,!,"<span class=ButtonDiv ID="""" style=""cursor:hand;"" onmouseover=""this.className='ButtonDivHover'"" onmouseout=""this.className='ButtonDiv'"" onclick=""windowclose();"" TITLE=""""><center>Отмена</center></span>"
	Write "</center>",!
	Write "</body>"
]]></Implementation>
</Method>

<Method name="OnPageCSPROOT">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write !
	Do ..OnPageHTML()
]]></Implementation>
</Method>

<Method name="OnPageHEAD">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<head>"
	Write !,"<link href=""style.css"" type=text/css rel=stylesheet>"
	Write !,"<style>"
	Write !,".LeftTop{border-left : 1 solid black;border-top : 1 solid black;}",!
	Write ".RightBottom{font-family:Arial;font-size:14px;border-right : 1 solid black;border-bottom : 1 solid black;}",!
	Write ".Kontragent{width:170px;cursor:hand;border:1 solid black}",!
	Write "</style>"
	Write !,"<script language=""jscript"" src=""common.js"">"
	Write "</script>"
	Write !,"<script language=""Jscript"" type=""text/javascript"">"
	Write !,"var sessionid="""_(sessionid)_""";",!
	Write !,"//функция выбора контрагента (подставит выбранного в innerText переданного объекта",!
	Write "function ChooseKonragent(Obj){",!
	Write "newItem=window.showModalDialog(""Dictionary.csp"",""Common.Kontragent"",""center:yes;status:no;dialogHeight:400px;dialogWidth:650px;resizable:yes;"");",!
	Write "if(newItem==null){return false;}",!
	Write "var newArr=newItem.split(InnerSplitter);",!
	Write "Obj.innerText=newArr[1];",!
	Write "Obj.Tag=newArr[0];",!
	Write "}",!
	Write !,"//функция выбора товара",!
	Write "function ChooseTovar(Obj){",!
	Write "newItem=window.showModalDialog(""selectgoods2.csp"","""",""center:yes;status:no;dialogHeight:700px;dialogWidth:800px;resizable:yes;"")",!
	Write "if(newItem==null)return",!
	Write "Goods=newItem.split(StringSplitter)",!
	Write "GoodsAttributes=newItem.split(InnerSplitter);",!
	Write "Obj.innerText=GoodsAttributes[9];",!
	Write "Obj.Tag=GoodsAttributes[0];",!
	Write "}",!
	Write !,"function startFun()",!
	Write "{",!
	Write "	alert(""ещё не реализовано"");",!
	Write "}",!
	Write "</script>"
	Write !,!,"<title>	Ручное создание акта технического осмотра от клиента</title>",!
	Write !,"</head>"
]]></Implementation>
</Method>

<Method name="OnPageHTML">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	Write "<html XMLNS:SKLADiGrid>"
	Write !,"<IMPORT NAMESPACE=""SKLADiGrid"" IMPLEMENTATION=""htc/iGridV7.htc"">",!
	Do ..OnPageHEAD()
	Write !,!
	Do ..OnPageBODY()
	Write !,"</html>"
]]></Implementation>
</Method>

<Method name="OnPreHTTP">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec/>
<Language>cache</Language>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
  i %session.NewSession d
  . s %session.EndSession=1
  . s sessionid=%request.Get("sessionid",1)
  . s %session=%session.GetSession(sessionid)
  .  s login=$G(%session.Data("user"))
  . i '+login s %response.ServerSideRedirect="norights.csp" 
  e  s sessionid=%session.SessionId
  
 Quit 1
 
]]></Implementation>
</Method>

<Parameter name="CSPFILE">
<Default>c:\cachesys\csp\sklad2\ActFromClient.CSP</Default>
</Parameter>

<Parameter name="CSPURL">
<Default>/csp/sklad2/ActFromClient.CSP</Default>
</Parameter>

<Parameter name="FileTimestamp">
<Default>62024,3594</Default>
</Parameter>
</Class>
</Export>
