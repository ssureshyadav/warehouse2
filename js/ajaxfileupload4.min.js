jQuery.extend({handleError:function(a,b,c,d){a.error&&a.error(b,c,d);a.global&&jQuery.event.trigger("ajaxError",[b,a,d])}});
jQuery.extend({createUploadIframe:function(a,b){var c="jUploadFrame"+a,d='<iframe id="'+c+'" name="'+c+'" style="position:absolute; top:-9999px; left:-9999px"';window.ActiveXObject&&(typeof b=="boolean"?d+=' src="javascript:false"':typeof b=="string"&&(d+=' src="'+b+'"'));d+=" />";jQuery(d).appendTo(document.body);return jQuery("#"+c).get(0)},createUploadForm:function(a,b,c){var d="jUploadForm"+a,a="jUploadFile"+a,d=jQuery('<form  action="" method="POST" name="'+d+'" id="'+d+'" enctype="multipart/form-data"></form>');
if(c)for(var h in c)$('<input type="hidden" name="'+h+'"/>').appendTo(d).val(c[h]);b=jQuery("#"+b);c=jQuery(b).clone();jQuery(b).attr("id",a);jQuery(b).before(c);jQuery(b).appendTo(d);jQuery(d).css("position","absolute");jQuery(d).css("top","-1200px");jQuery(d).css("left","-1200px");jQuery(d).appendTo("body");return d},ajaxFileUpload:function(a){var a=jQuery.extend({},jQuery.ajaxSettings,a),b=(new Date).getTime(),c=jQuery.createUploadForm(b,a.fileElementId,typeof a.data=="undefined"?false:a.data);
jQuery.createUploadIframe(b,a.secureuri);var d="jUploadFrame"+b,b="jUploadForm"+b;a.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var h=false,e={};a.global&&jQuery.event.trigger("ajaxSend",[e,a]);var i=function(b){var f=document.getElementById(d);try{if(f.contentWindow)e.responseText=f.contentWindow.document.body?f.contentWindow.document.body.innerHTML:null,e.responseXML=f.contentWindow.document.XMLDocument?f.contentWindow.document.XMLDocument:f.contentWindow.document;else if(f.contentDocument)e.responseText=
f.contentDocument.document.body?f.contentDocument.document.body.innerHTML:null,e.responseXML=f.contentDocument.document.XMLDocument?f.contentDocument.document.XMLDocument:f.contentDocument.document}catch(i){jQuery.handleError(a,e,null,i)}if(e||b=="timeout"){h=true;var g;try{if(g=b!="timeout"?"success":"error",g!="error"){var j=jQuery.uploadHttpData(e,a.dataType);a.success&&a.success(j,g);a.global&&jQuery.event.trigger("ajaxSuccess",[e,a])}else jQuery.handleError(a,e,g)}catch(k){g="error",jQuery.handleError(a,
e,g,k)}a.global&&jQuery.event.trigger("ajaxComplete",[e,a]);a.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop");a.complete&&a.complete(e,g);jQuery(f).unbind();setTimeout(function(){try{jQuery(f).remove(),jQuery(c).remove()}catch(b){jQuery.handleError(a,e,null,b)}},100);e=null}};a.timeout>0&&setTimeout(function(){h||i("timeout")},a.timeout);try{c=jQuery("#"+b),jQuery(c).attr("action",a.url),jQuery(c).attr("method","POST"),jQuery(c).attr("target",d),c.encoding?jQuery(c).attr("encoding","multipart/form-data"):
jQuery(c).attr("enctype","multipart/form-data"),jQuery(c).submit()}catch(j){jQuery.handleError(a,e,null,j)}jQuery("#"+d).load(i);return{abort:function(){}}},uploadHttpData:function(a,b){var c;c=b=="xml"||!b?a.responseXML:a.responseText;b=="script"&&jQuery.globalEval(c);b=="json"&&eval("data = "+c);b=="html"&&jQuery("<div>").html(c).evalScripts();return c}});
